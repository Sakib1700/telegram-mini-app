<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Telegram Funny Tasks</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f2f2f2;
      padding: 20px;
      text-align: center;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      max-width: 400px;
      margin: 0 auto;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    button {
      padding: 10px 20px;
      border: none;
      background: #0088cc;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      margin: 10px 0;
    }
    input {
      padding: 8px;
      width: 80%;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2 id="welcome">Welcome!</h2>
    <p id="points">Points: 0</p>
    <button id="startBtn">Start Tasks</button>
    <div id="taskArea"></div>
    <div id="withdrawArea" style="display:none;">
      <button onclick="showWithdrawForm()">Withdraw $0.02</button>
      <div id="paypalForm" style="display:none;">
        <input type="email" id="paypalEmail" placeholder="Your PayPal Email"/>
        <button onclick="submitWithdraw()">Submit</button>
      </div>
    </div>
  </div>  <script>
    let user = {
      id: 'guest',
      name: 'Friend',
      points: 0
    };
    let taskIndex = 0;
    let clicks = 0;

    if (window.Telegram && Telegram.WebApp) {
      Telegram.WebApp.ready();
      const tgUser = Telegram.WebApp.initDataUnsafe?.user;
      if (tgUser) {
        user.id = tgUser.id;
        user.name = tgUser.first_name;
      }
    }

    document.getElementById("welcome").textContent = "Hi, " + user.name + "!";
    document.getElementById("startBtn").onclick = startTasks;

    const tasks = [
      () => `<p>Tap fast: <button onclick="clickTask()">Tap</button> <span id="clickCount">0</span></p>`,
      () => `<p>Match: Which is ðŸ™‚?<br><button onclick="emojiMatch('ðŸ™‚')">ðŸ™‚</button> <button onclick="emojiMatch('ðŸ˜Ž')">ðŸ˜Ž</button></p>`,
      () => `<p>React Fast: <button id="reactBtn" disabled>Wait...</button></p>`,
      () => `<p>Guess number (1-5): <input type="number" id="guess"><button onclick="guessNumber()">Guess</button></p>`,
      () => `<p>Repeat this code: <b id="code">321</b><br><input id="memoryInput"><button onclick="checkMemory()">Submit</button></p>`
    ];

    function startTasks() {
      taskIndex = 0;
      nextTask();
    }

    function nextTask() {
      if (taskIndex >= tasks.length) taskIndex = 0;
      document.getElementById("taskArea").innerHTML = tasks[taskIndex]();

      if (taskIndex === 2) {
        let btn = document.getElementById("reactBtn");
        setTimeout(() => {
          btn.textContent = "NOW!";
          btn.disabled = false;
          btn.onclick = () => {
            addPoints();
            taskIndex++;
            nextTask();
          };
        }, 1000 + Math.random() * 2000);
      }

      if (taskIndex === 4) {
        document.getElementById("code").textContent = "321";
      }

      if (taskIndex !== 2) taskIndex++;
    }

    function clickTask() {
      clicks++;
      document.getElementById("clickCount").textContent = clicks;
      if (clicks >= 5) {
        clicks = 0;
        addPoints();
        taskIndex++;
        nextTask();
      }
    }

    function emojiMatch(choice) {
      if (choice === 'ðŸ™‚') {
        addPoints();
        taskIndex++;
        nextTask();
      } else {
        alert("Try again!");
      }
    }

    function guessNumber() {
      let guess = parseInt(document.getElementById("guess").value);
      let correct = Math.floor(Math.random() * 5) + 1;
      if (guess === correct) addPoints();
      else alert("Wrong! It was " + correct);
      taskIndex++;
      nextTask();
    }

    function checkMemory() {
      let val = document.getElementById("memoryInput").value;
      if (val === "321") addPoints();
      else alert("Wrong code!");
      taskIndex++;
      nextTask();
    }

    function addPoints() {
      user.points += 10;
      document.getElementById("points").textContent = "Points: " + user.points;
      if (user.points >= 200) {
        document.getElementById("withdrawArea").style.display = "block";
      }
    }

    function showWithdrawForm() {
      document.getElementById("paypalForm").style.display = "block";
    }

    function submitWithdraw() {
      const email = document.getElementById("paypalEmail").value.trim();
      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailPattern.test(email)) {
        alert("Invalid email!");
        return;
      }

      alert("Request submitted. You'll get $0.02 soon!");

      fetch("https://api.telegram.org/bot8168793684:AAEO8Nvc3OXc_pYmw4-lddMl3bUJ-3wX6mo/sendMessage", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          chat_id: "8168793684",
          text: `\u{1F911} New Withdrawal Request:\n\nName: ${user.name}\nUser ID: ${user.id}\nPoints: ${user.points}\nPayPal: ${email}`
        })
      });

      // Reset after withdrawal
      user.points = 0;
      document.getElementById("points").textContent = "Points: 0";
      document.getElementById("withdrawArea").style.display = "none";
      document.getElementById("paypalForm").style.display = "none";
      document.getElementById("paypalEmail").value = "";
    }
  </script></body>
</html>
